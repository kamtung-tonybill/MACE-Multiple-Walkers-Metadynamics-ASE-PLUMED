# Read the COLVAR file
cv1: READ FILE=COLVAR IGNORE_TIME VALUES=cv1
# Assume we want to reweigh the simulation on the number of H-bonds received by the NO2 fragment based on the H-bonds matrix
cv2: READ FILE=COLVAR IGNORE_TIME VALUES=hmat2.sum
metad: READ FILE=COLVAR IGNORE_TIME VALUES=metad.rbias

# Define weights
weights: REWEIGHT_METAD TEMP=300

# Calculate histograms
# Assume the errors converge at a block size of 25 ps
hh: HISTOGRAM ARG=cv1,cv2.sum GRID_MIN=0.1,0.0 GRID_MAX=0.4,5.0 GRID_BIN=255,255 BANDWIDTH=0.01,0.05 LOGWEIGHTS=weights NORMALIZATION=true CLEAR=5000
DUMPGRID GRID=hh FILE=histogram.dat STRIDE=5000
